<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .sidebar {
            height: 100vh;
            background-color: #f8f9fa;
            padding: 20px;
        }
        .admin-panel-info {
            background-color: #343a40;
            color: white;
            padding: 10px;
        }
        .tab {
            cursor: pointer;
            padding: 10px;
            margin-right: 10px;
            background-color: #f8f9fa;
            border: none;
        }
        .tab.active {
            background-color: #e9ecef;
            color: black;
        }
        .hidden {
            display: none;
        }
        .visible {
            display: block;
        }
        .nav-tabs {
            padding: 10px 0;
        }
    </style>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.9.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
$(document).ready(function() {
    // Обработка клика по вкладкам
    $('.tab').click(function() {
        var tabId = $(this).data('target');
        $('.tab').removeClass('active'); // Убираем активный класс со всех вкладок
        $(this).addClass('active'); // Добавляем класс активности к текущей вкладке
        $('.visible, .hidden').addClass('hidden').removeClass('visible');
        $('#' + tabId).addClass('visible').removeClass('hidden');
    });

    // Обработка клика по ссылкам навигации
    $('.nav-link').click(function() {
        var sectionId = $(this).data('target');
        $('.visible, .hidden').addClass('hidden').removeClass('visible');
        $('#' + sectionId).addClass('visible').removeClass('hidden');
    });

    // Инициализация модальных окон Bootstrap
    $('[data-toggle="modal"]').click(function() {
        var modalId = $(this).data('target');
        $(modalId).modal('show');
    });
});
</script>
</head>
<body>




<div class="admin-panel-info">
    <div class="container">
        <span sec:authentication="name">[Username]</span> with roles: 
        <span sec:authentication="authorities">[Roles]</span>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
            <div class="sidebar-sticky">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" data-target="userTable" href="#">Admin</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-target="userProfile" href="#">User</a>
                    </li>
                </ul>
            </div>
        </nav>

        <main role="main" class="col-md-10 ml-sm-auto col-lg-10 px-4">
            <div class="nav-tabs">
                <button class="tab" data-target="userTable">Users table</button>
                <button class="tab" data-target="addUserForm">New User</button>
            </div>
            <div id="userTable" class="visible">
                <h2>Admin panel</h2>
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Email</th>
                            <th>Roles</th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="user : ${users}">
                            <td th:text="${user.id}">1</td>
                            <td th:text="${user.firstName}">John</td>
                            <td th:text="${user.lastName}">Doe</td>
                            <td th:text="${user.email}">john.doe@example.com</td>
                            <td>
                                <span th:each="role, iterStat : ${user.roles}" th:text="${role.name} + (iterStat.last ? '' : ', ')">Admin, User</span>
                            </td>
                            <td>
                                <!-- Button trigger modal -->
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editUserModal-${user.id}">
                                    Edit
                                </button>
                            </td>
                            <td>
                                <form th:action="@{/admin/delete}" method="post" onsubmit="return confirm('Are you sure you want to delete this user?');">
                                    <input type="hidden" name="userId" th:value="${user.id}" />
                                    <button type="submit" class="btn btn-danger">Delete</button>
                                </form>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div id="addUserForm" class="hidden">
                <h2>Add New User</h2>
                <!-- Add user form content goes here -->
            </div>
            <div id="userProfile" class="hidden">
                <h2>User Profile</h2>
                <!-- User profile content goes here -->
            </div>
        </main>
    </div>
</div>

<!-- Modal for Edit User -->
<div class="modal fade" id="editUserModal" tabindex="-1" role="dialog" aria-labelledby="editUserModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editUserModalLabel">Edit User</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form th:action="@{/admin/edit}" method="post" th:object="${user}" id="editUserForm">
                    <input type="hidden" name="id" th:field="*{id}"/>
                    <div class="form-group">
                        <label for="firstNameModal">First Name:</label>
                        <input type="text" class="form-control" id="firstNameModal" th:field="*{firstName}"/>
                    </div>
                    <div class="form-group">
                        <label for="lastNameModal">Last Name:</label>
                        <input type="text" class="form-control" id="lastNameModal" th:field="*{lastName}"/>
                    </div>
                    <div class="form-group">
                        <label for="emailModal">Email:</label>
                        <input type="email" class="form-control" id="emailModal" th:field="*{email}"/>
                    </div>
                    <div class="form-group">
                        <label for="roleModal">Role:</label>
                        <select class="form-control" id="roleModal" th:field="*{role}">
                            <option value="ADMIN">Admin</option>
                            <option value="USER">User</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </form>
            </div>
        </div>
    </div>
</div>



</body>
</html>
